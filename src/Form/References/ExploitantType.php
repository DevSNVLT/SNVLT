<?php

namespace App\Form\References;

use App\Entity\References\Cantonnement;
use App\Entity\References\QualiteExploitant;
use App\Entity\References\Exploitant;
use App\Repository\References\CantonnementRepository;
use Doctrine\ORM\QueryBuilder;
use Symfony\Bridge\Doctrine\Form\Type\EntityType;
use Symfony\Component\Form\AbstractType;
use Symfony\Component\Form\Extension\Core\Type\CheckboxType;
use Symfony\Component\Form\Extension\Core\Type\DateType;
use Symfony\Component\Form\Extension\Core\Type\IntegerType;
use Symfony\Component\Form\Extension\Core\Type\NumberType;
use Symfony\Component\Form\Extension\Core\Type\TextareaType;
use Symfony\Component\Form\Extension\Core\Type\TextType;
use Symfony\Component\Form\FormBuilderInterface;
use Symfony\Component\OptionsResolver\OptionsResolver;
use Symfony\Component\Validator\Constraints\Length;
use Symfony\Component\Validator\Constraints\NotBlank;

class ExploitantType extends AbstractType
{
    public function buildForm(FormBuilderInterface $builder, array $options): void
    {
        $builder
            ->add('numero_exploitant', IntegerType::class, [
                'label'=>'Code exploitant',
                'label_attr'=>[
                    'class'=>'fw-bold text-dark '
                ],
                'attr'=>[
                    ' class'=>'form-control alert-light text-primary',
                    'style'=>'font-size:16px;text-transform:uppercase;background:lightyellow;'
                ],
                'constraints' => [
                    new NotBlank([
                        'message' => 'Le numéro exploitant est obligatoire',
                    ])
                ],
                'required'=>true
            ])

            ->add('raison_sociale_exploitant', TextType::class, [
                'label'=>'Raison sociale de l\'exploitant',
                'label_attr'=>[
                    'class'=>'fw-bold text-dark'
                ],
                'attr'=>[
                    'class'=>'form-control alert-light text-primary uppercase',
                    'style'=>'font-size:16px;text-transform:uppercase;background:lightyellow;'
                ],
                'constraints' => [
                    new NotBlank([
                        'message' => 'Merci de renseignez la raison sociale° de l\'exploitant',
                    ])
                ],
                'required'=>true
            ])

            ->add('sigle', TextType::class, [
                'label'=>'Sigle',
                'label_attr'=>[
                    'class'=>'fw-bold text-dark'
                ],
                'attr'=>[
                    'class'=>'form-control alert-light text-primary',
                    'style'=>'font-size:16px;text-transform:uppercase;background:lightyellow;'
                ]
            ])

            ->add('code_qualite', EntityType::class, [
                'label'=>'Qualité',
                'class'=> QualiteExploitant::class,
                'label_attr'=>[
                    'class'=>'fw-bold text-dark'
                ],
                'attr'=>[
                    'class'=>'choices form-control form-select multiple-remove alert-light text-primary qualite mt-1 mb-2',
                    'style'=>'background:lightyellow;'
                ],
                'multiple'=>true,
                'expanded'=>false
            ])

            ->add('marteau_exploitant', TextType::class, [
                'label'=>'Marteau',
                'label_attr'=>[
                    'class'=>'fw-bold text-dark'
                ],
                'attr'=>[
                    'class'=>'form-control alert-light text-primary',
                    'style'=>'font-size:16px;text-transform:uppercase;background:lightyellow;'
                ],
                'constraints' => [
                    new Length([
                        'max'=>3,
                        'maxMessage'=> 'Le marteau doit être de 03 caractères au plus'
                    ]),
                    new NotBlank([
                        'message' => 'Le marteau exploitant est obligatoire',
                    ]),
                ],
                'required'=>true
            ])

            ->add('tel_exploitant', TextType::class, [
                'label'=>'Téléphone fixe',
                'label_attr'=>[
                    'class'=>'fw-bold text-dark'
                ],
                'attr'=>[
                    'class'=>'form-control alert-light text-primary',
                    'style'=>'font-size:16px;text-transform:uppercase;background:lightyellow;'
                ]
            ])
            ->add('mobile_exploitant', TextType::class, [
                'label'=>'Téléphone mobile',
                'label_attr'=>[
                    'class'=>'fw-bold text-dark'
                ],
                'attr'=>[
                    'class'=>'form-control alert-light text-primary',
                    'style'=>'font-size:16px;text-transform:uppercase;background:lightyellow;'
                ]
            ])

            ->add('email_info', TextType::class, [
                'label'=>'Email de la structure',
                'label_attr'=>[
                    'class'=>'fw-bold text-dark'
                ],
                'attr'=>[
                    'class'=>'form-control alert-light text-primary',
                    'style'=>'font-size:16px;background:lightyellow;'
                ]
            ])

            ->add('fax', TextType::class, [
                'label'=>'Fax',
                'label_attr'=>[
                    'class'=>'fw-bold text-dark'
                ],
                'attr'=>[
                    'class'=>'form-control alert-light text-primary',
                    'style'=>'font-size:16px;text-transform:uppercase;background:lightyellow;'
                ]
            ])
            ->add('adresse_exploitant', TextType::class, [
                'label'=>'Adresse',
                'label_attr'=>[
                    'class'=>'fw-bold text-dark'
                ],
                'attr'=>[
                    'class'=>'form-control alert-light text-primary',
                    'style'=>'font-size:16px;text-transform:uppercase;background:lightyellow;'
                ]
            ])

            ->add('situation_geographie', TextareaType::class, [
                'label'=>'Description de la localisation',
                'label_attr'=>[
                    'class'=>'fw-bold text-dark'
                ],
                'attr'=>[
                    'class'=>'form-control alert-light text-primary',
                    'style'=>'min-height:150px;font-size:16px;text-transform:uppercase;background:lightyellow;'
                ]
            ])
            ->add('datecreation', DateType::class, [
                'label'=>'Date de création',
                'widget' => 'single_text',
                'label_attr'=>[
                    'class'=>'fw-bold text-dark'
                ],
                'attr'=>[
                    'class'=>'form-control text-primary datecreation',
                    'style'=>'font-size:16px;text-transform:uppercase;background:lightyellow;'
                ]
            ])
            ->add('ncc_exploitant', TextType::class, [
                'label'=>'Compte contribuable',
                'label_attr'=>[
                    'class'=>'fw-bold text-dark'
                ],
                'attr'=>[
                    'class'=>'form-control alert-light text-primary',
                    'style'=>'font-size:16px;text-transform:uppercase;background:lightyellow;'
                ]
            ])


            ->add('forme_juridique', TextType::class, [
                'label'=>'Forme juridique',
                'label_attr'=>[
                    'class'=>'fw-bold text-dark'
                ],
                'attr'=>[
                    'class'=>'form-control alert-light text-primary',
                    'style'=>'font-size:16px;text-transform:uppercase;background:lightyellow;'
                ]
            ])
            ->add('capital', IntegerType::class, [
                'label'=>'Capital',
                'label_attr'=>[
                    'class'=>'fw-bold text-dark'
                ],
                'attr'=>[
                    'class'=>'form-control alert-light text-primary',
                    'style'=>'font-size:16px;text-transform:uppercase;background:lightyellow;'
                ]
            ])

            ->add('rccim', TextType::class, [
                'label'=>'RCCIM',
                'label_attr'=>[
                    'class'=>'fw-bold text-dark'
                ],
                'attr'=>[
                    'class'=>'form-control alert-light text-primary',
                    'style'=>'font-size:16px;text-transform:uppercase;background:lightyellow;'
                ]
            ])





            ->add('nb_salarie', IntegerType::class, [
                'label'=>'Nombre salariés',
                'label_attr'=>[
                    'class'=>'fw-bold text-dark'
                ],
                'attr'=>[
                    'class'=>'form-control alert-light text-primary',
                    'style'=>'font-size:16px;text-transform:uppercase;background:lightyellow;'
                ]
            ])

            ->add('ca', TextType::class, [
                'label'=>'Chiffres d\'afffaires',
                'label_attr'=>[
                    'class'=>'fw-bold text-dark'
                ],
                'attr'=>[
                    'class'=>'form-control alert-light text-primary',
                    'style'=>'font-size:16px;text-transform:uppercase;background:lightyellow;'
                ]
            ])

            ->add('gerant', TextType::class, [
                'label'=>'Gérant',
                'label_attr'=>[
                    'class'=>'fw-bold text-dark'
                ],
                'attr'=>[
                    'class'=>'form-control alert-light text-primary',
                    'style'=>'font-size:16px;text-transform:uppercase;background:lightyellow;'
                ]
            ])

            ->add('personne_ressource', TextType::class, [
                'label'=>'Personne ressource',
                'label_attr'=>[
                    'class'=>'fw-bold text-dark'
                ],
                'attr'=>[
                    'class'=>'form-control alert-light text-primary',
                    'style'=>'font-size:16px;text-transform:uppercase;background:lightyellow;'
                ]
            ])

            ->add('email_personne_ressource', TextType::class, [
                'label'=>'Email de la personne ressource',
                'label_attr'=>[
                    'class'=>'fw-bold text-dark'
                ],
                'attr'=>[
                    'class'=>'form-control alert-light text-primary',
                    'style'=>'font-size:16px;background:lightyellow;'
                ]
            ])

        ->add('mobile_personne_ressource', TextType::class, [
                'label'=>'Mobile de la personne ressource',
                'label_attr'=>[
                    'class'=>'fw-bold text-dark'
                ],
                'attr'=>[
                    'class'=>'form-control alert-light text-primary;background:lightyellow;'
                ]
            ])

            ->add('export', CheckboxType::class, [
                'label'=>'Cet exploitant forestier est-il exportateur ?',
                'label_attr'=>[
                    'class'=>'font-weight-bold text-danger'
                ],'attr'=>[
                    'class'=>'form-check-input mt-1 mb-2',
                    'style'=>'cursor: pointer;',
                    'role'=>'switch'
                ]
            ])

            ->add('code_exportateur', TextType::class, [
                'label'=>false,
                'label_attr'=>[
                    'class'=>'fw-bold text-dark  mt-1 mb-2'
                ],
                'attr'=>[
                    'class'=>'form-control alert-light text-primary',
                    'placeholder'=>'Code Exportateur',
                    'style'=>'border: 1px solid darkgreen;font-size:16px;text-transform:uppercase;background:lightyellow;'
                ]
            ])

            ->add('code_cantonnement', EntityType::class, [
                'label'=>'Sélectionnez le cantonnement forestier',
                'label_attr'=>[
                    'class'=>'fw-bold text-dark'
                ],
                'placeholder'=>'',
                'class'=> Cantonnement::class,
                'multiple'=>false,
                'expanded'=>false,
                'attr'=>[
                    'class'=>'form-control code_cantonnement alert-light text-primary mt-1 mb-2',
                    'placeholder'=>'--Sélectionnez le cantonnement forestier...',
                    'style'=>'background:lightyellow;'
                ],
                'required'=>false,
                'query_builder' => function (CantonnementRepository $er): QueryBuilder {
                    return $er->createQueryBuilder('c')
                        ->orderBy('c.nom_cantonnement', 'ASC');
                }
            ])
            ->add('latitude', NumberType::class, [
                'label'=>false,
                'label_attr'=>[
                    'class'=>'font-weight-bold text-dark'
                ],
                'attr'=>[
                    'placeholder'=>'Latitude',
                    'class'=>'form-control alert-light text-primarylatitude',
                    'readOnly'=>true,
                    'style'=>'background:lightyellow;'
                ]
            ])
            ->add('longitude', NumberType::class, [
                'label'=>false,
                'label_attr'=>[
                    'class'=>'font-weight-bold text-dark'
                ],
                'attr'=>[
                    'placeholder'=>'Longitude',
                    'class'=>'form-control alert-light text-primarylongitude',
                    'readOnly'=>true,
                    'style'=>'background:lightyellow;'
                ]
            ])
        ;
    }

    public function configureOptions(OptionsResolver $resolver): void
    {
        $resolver->setDefaults([
            'data_class' => Exploitant::class,
        ]);
    }
}
